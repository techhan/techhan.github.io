---
title: "2021ë…„ 01ì›” 06ì¼"
excerpt: "wsp - ê²Œì‹œíŒ ìƒì„¸ì¡°íšŒ, ê²Œì‹œê¸€ ì‘ì„±, ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ë“±"
search: true
categories: 
  - Academy
tags: 
  - Ajax
  - JavaScript
  - JQuery
  - JSP
toc: true
---

## ê²Œì‹œíŒ ìƒì„¸ì¡°íšŒ
- ê²Œì‹œíŒ ëª©ë¡ì—ì„œ í•œ í–‰ì„ í´ë¦­ ì‹œ ìƒì„¸ì¡°íšŒ <br> ![20210106_01](https://user-images.githubusercontent.com/70805241/103719616-bc111d80-500c-11eb-90f6-ebb037e4601a.JPG) <br><br><br>

### í•œ í–‰ í´ë¦­ (boardList.jsp)

```html
<!-- í•˜ë‹¨ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±-->
<script>
    // ê²Œì‹œê¸€ ìƒì„¸ë³´ê¸° ê¸°ëŠ¥ (jqueryë¥¼ í†µí•´ ì‘ì—…)
    
    $("#list-table td").on("click", function(){
        
        // ê²Œì‹œê¸€ ë²ˆí˜¸ ì–»ì–´ì˜¤ê¸°
        var boardNo = $(this).parent().children().eq(0).text();
        //console.log(boardNo);
        
        var url = "${contextPath}/board/view.do?cp=${pInfo.currentPage}&no=" + boardNo;
        
        location.href = url;
    });
</script>
```
<br><br>


### BoardController.java

```java
// ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ Controller ****************************
else if(command.equals("/view.do")) {
    errorMsg = "ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ ê³¼ì •ì—ì„œ ì˜¤ë¥˜ ë°œìƒ";
    
    int boardNo = Integer.parseInt(request.getParameter("no"));

    //ìƒì„¸ì¡°íšŒ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰ í›„ ê²°ê³¼ ë°˜í™˜ ë°›ê¸°
    Board board = service.selectBoard(boardNo);
    
    if(board != null) {// ìƒì„¸ì¡°íšŒ ì„±ê³µ
        path = "/WEB-INF/views/board/boardView.jsp";
        request.setAttribute("board", board);
        view = request.getRequestDispatcher(path);
        view.forward(request, response);
    }else {
        request.getSession().setAttribute("swalIcon", "error");
        request.getSession().setAttribute("swalTitle", "ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ ì‹¤íŒ¨");
        
        // ì¡°íšŒê°€ ì‹¤íŒ¨í–ˆì„ ê²½ìš° ì²«ë²ˆì§¸ í˜ì´ì§€ë¡œ ì´ë™
        response.sendRedirect("list.do?cp=1");
    }
}
```
<br><br>

### BoardService.java

```java
/** ê²Œì‹œê¸€ ìƒì„¸ì¡°íšŒ 
    * @param boardNo
    * @return board
    * @throws Exception
    */
public Board selectBoard(int boardNo) throws Exception{
    Connection conn = getConnection();
    Board board = dao.selectBoard(conn, boardNo);
    close(conn);
    
    return board;
}
```
<br><br>

### board-query.xml

```sql
<!-- ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ  -->
<entry key="selectBoard">
SELECT * FROM V_BOARD
WHERE BOARD_NO = ?
AND BOARD_STATUS = 'Y'
</entry>
```
<br><br>


### BoardDAO.java

```java
/** ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ DAO
    * @param conn
    * @param boardNo
    * @return board
    * @throws Exception
    */
public Board selectBoard(Connection conn, int boardNo) throws Exception {
    Board board = null;
    String query = prop.getProperty("selectBoard");
    
    try {
        pstmt = conn.prepareStatement(query);
        pstmt.setInt(1, boardNo);
        
        rset = pstmt.executeQuery();
        
        if(rset.next()) {
            board = new Board();
            
            board.setBoardNo(rset.getInt("BOARD_NO"));
            board.setBoardTitle(rset.getString("BOARD_TITLE"));
            board.setBoardContent(rset.getString("BOARD_CONTENT"));
            board.setMemberId(rset.getString("MEMBER_ID"));
            board.setReadCount(rset.getInt("READ_COUNT"));
            board.setBoardCreateDate(rset.getTimestamp("BOARD_CREATE_DT"));
            board.setBoardModifyDate(rset.getTimestamp("BOARD_MODIFY_DT"));
            board.setCategoryName(rset.getString("CATEGORY_NM"));
        }
    } finally {
        close(rset);
        close(pstmt);
    }
    return board;
}
```
<br><br>

### boardView.jsp

```html
<!-- el í˜•ì‹ìœ¼ë¡œ ë‚´ìš© ì±„ìš°ê¸° -->
<h6 class="mt-4">ì¹´í…Œê³ ë¦¬ : [${board.categoryName }]</h6>

<h3 class="mt-4">${board.boardTitle}</h3>

<p class="lead">
    ì‘ì„±ì : ${board.memberId }
</p>

<p>
<span class="board-dateArea">
    ì‘ì„±ì¼ : <fmt:formatDate value="${board.boardCreateDate}" pattern="yyyyë…„ MMì›” ddì¼ HH:mm:ss"/>
    <br>
    ë§ˆì§€ë§‰ ìˆ˜ì •ì¼ : <fmt:formatDate value="${board.boardModifyDate}" pattern="yyyyë…„ MMì›” ddì¼ HH:mm:ss"/>
</span>
<span class="float-right">ì¡°íšŒìˆ˜ ${board.readCount }</span>
</p>

<div id="board-content">${board.boardContent }</div>
```
<br><br>


## ìƒì„¸ì¡°íšŒ ë²„íŠ¼ ê´€ë ¨ ê¸°ëŠ¥

### ëª©ë¡ìœ¼ë¡œ (boardView.jsp)
- ![20210106_03](https://user-images.githubusercontent.com/70805241/103721563-4d828e80-5011-11eb-9c9c-aa823ab5c089.gif) <br><br>

```html
<c:url var="goToList" value="list.do">
    <c:param name="cp">${param.cp}</c:param>
</c:url>
    <a href="${goToList}" class="btn btn-primary float-right">ëª©ë¡ìœ¼ë¡œ</a>
```

## ê²Œì‹œê¸€ ì‘ì„±ìì™€ ë¡œê·¸ì¸í•œ íšŒì›ì´ ê°™ì„ ì‹œ
- ë¡œê·¸ì¸ íšŒì›ê³¼ ì‘ì„±ìê°€ ë‹¤ë¥¼ ì‹œ <br> ![20210106_02](https://user-images.githubusercontent.com/70805241/103721562-4ce9f800-5011-11eb-87ec-c8991d3ff6f2.JPG) <br><br>
- ë¡œê·¸ì¸ íšŒì›ê³¼ ì‘ì„±ìê°€ ê°™ì„ ì‹œ <br> ![20210106_03](https://user-images.githubusercontent.com/70805241/103721899-28425000-5012-11eb-96d2-7080ae7915d9.JPG)<br><br>

```html
<c:if test="${ !empty loginMember &&(board.memberId == loginMember.memberId) }"> 
    <button id="deleteBtn" class="btn btn-primary float-right">ì‚­ì œ</button> 
    <a href="#" class="btn btn-primary float-right ml-1 mr-1">ìˆ˜ì •</a>
</c:if>
```

<br><br>


## ì¡°íšŒìˆ˜ ì¦ê°€

### BoardService.java

```java
// ê²Œì‹œê¸€ ìƒì„¸ì¡°íšŒ ë©”ì†Œë“œ ë‚´ì— ì‘ì„±í•œë‹¤.

// ì¡°íšŒìˆ˜ ì¦ê°€ 
if(board != null) { // DBì—ì„œ ì¡°íšŒ ì„±ê³µ ì‹œ
    
    int result = dao.increaseReadCount(conn, boardNo);
    
    if(result > 0) {
        commit(conn);
        
        // ë°˜í™˜ë˜ëŠ” Board ë°ì´í„°ì—ëŠ” ì¡°íšŒìˆ˜ê°€ ì¦ê°€ë˜ì–´ ìˆì§€ ì•Šê¸° ë–„ë¬¸ì—
        // ì¡°íšŒìˆ˜ë¥¼ 1 ì¦ê°€ ì‹œì¼œì¤Œ
        board.setReadCount(board.getReadCount() + 1);
    }
    else rollback(conn);
}
```
<br><br>

### board-query.xml

```sql
<!-- ì¡°íšŒìˆ˜ ì¦ê°€  -->
<entry key="increaseReadCount">
UPDATE BOARD SET
READ_COUNT = READ_COUNT + 1
WHERE BOARD_NO = ?
</entry>
```
<br><br>

### BoardDAO.java

```java
/** ì¡°íšŒìˆ˜ ì¦ê°€ DAO 
    * @param conn
    * @param boardNo
    * @return result
    * @throws Exception
    */
public int increaseReadCount(Connection conn, int boardNo) throws Exception {
    int result = 0;
    String query = prop.getProperty("increaseReadCount");
    
    try {
        pstmt = conn.prepareStatement(query);
        pstmt.setInt(1, boardNo);
        
        result = pstmt.executeUpdate();
    } finally {
        close(pstmt);
    }
    return result;
}
```
<br><br>

## ê²€ìƒ‰ ê¸°ëŠ¥
- ì œëª©, ë‚´ìš©, ì œëª© + ë‚´ìš©, ì‘ì„±ì ê²€ìƒ‰ ì‹œ <br> ![20210106_04](https://user-images.githubusercontent.com/70805241/103768541-096da900-5066-11eb-8640-279ddaf00cdf.gif) <br><br><br>

### boardList.jsp

```html
<!-- í˜ì´ì§• ì²˜ë¦¬ ë¶€ë¶„ ì£¼ì†Œ ì¡°ê±´ -->
<c:choose>
            <%-- ê²€ìƒ‰ ë‚´ìš©ì´ íŒŒë¼ë¯¸í„°ì— ì¡´ì¬í•  ë•Œ == ê²€ìƒ‰ì„ í†µí•´ ë§Œë“¤ì–´ì§„ í˜ì´ì§€ì¸ê°€? --%>
<c:when test="${!empty param.sk && !empty param.sv}">
    <c:url var="pageUrl" value="/search.do"/>
    
    <%-- ì¿¼ë¦¬ ìŠ¤íŠ¸ë§ìœ¼ë¡œ ì‚¬ìš©í•  ë‚´ìš©ì„ ë³€ìˆ˜ì— ì €ì¥ --%>
    <c:set var="searchStr" value="&sk=${param.sk}&sv=${param.sv}"/>
</c:when>

<c:otherwise>
    <c:url var="pageUrl" value="/board/list.do"/>
</c:otherwise>
</c:choose>

<!-- í˜ì´ì§• ì²˜ë¦¬ ë¶€ë¶„ ì¤‘ ì£¼ì†Œ ë³€ê²½ -->
<%--
ê²€ìƒ‰ì„ ì•ˆí–ˆì„ ë•Œ : /board/list.do?cp=1
ê²€ìƒ‰ì„ í–ˆì„ ë•Œ : /search.do?cp=1&sk=title&sv=49
--%>
<c:set var="firstPage" value="${pageUrl}?cp=1"/>
<c:set var="lastPage" value="${pageUrl}?cp=${pInfo.maxPage}${searchStr}"/>

<%-- ELì„ ì´ìš©í•œ ìˆ«ì ì—°ì‚°ì˜ ë‹¨ì  : ì—°ì‚°ì´ ìë£Œí˜•ì— ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ”ë‹¤. ex) 5/2 = 2.5 --%>
<%-- <fmt:parseNumber> : ìˆ«ì í˜•íƒœë¥¼ ì§€ì •í•˜ì—¬ ë³€ìˆ˜ ì„ ì–¸ 
integerOnly="true" : ì •ìˆ˜ë¡œë§Œ ìˆ«ì í‘œí˜„ (ì†Œìˆ˜ì  ë²„ë¦¼)
--%>

<!-- í˜ì´ì§• ì²˜ë¦¬ ë¶€ë¶„ ì¤‘ ì£¼ì†Œ ë³€ê²½ -->
<c:forEach var="page" begin="${pInfo.startPage}" end="${pInfo.endPage}">
                    <!-- for(int page=0; page<=10; page++) ë¹„ìŠ·í•˜ë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤. -->
    <c:choose>
        <c:when test="${pInfo.currentPage == page}">
        <li>
            <a class="page-link">${page}</a>
        </li>
        </c:when>
        
        <c:otherwise>
        <li>
            <a class="page-link" href="${pageUrl}?cp=${page}${searchStr}">${page}</a>
        </li>
        </c:otherwise>
    </c:choose>
</c:forEach>


<fmt:parseNumber var="c1" value="${(pInfo.currentPage - 1)/10}" integerOnly="true"/>
<fmt:parseNumber var="prev" value="${c1 * 10}" integerOnly="true"/>
<c:set var="prevPage" value="${pageUrl}?cp=${prev}${searchStr}"/> <!-- /board/list/do?cp=10  -->

<fmt:parseNumber var="c2" value="${(pInfo.currentPage + 9)/10}" integerOnly="true"/>
<fmt:parseNumber var="next" value="${c2 * 10 + 1}" integerOnly="true"/>
<c:set var="nextPage" value="${pageUrl}?cp=${next}${searchStr}"/>

<div class="my-5">
<form action="${contextPath}/search.do" method="GET" class="text-center" id="searchForm">
    <select name="sk" class="form-control" style="width: 100px; display: inline-block;">
        <option value="title">ê¸€ì œëª©</option>
        <option value="content">ë‚´ìš©</option>
        <option value="titcont">ì œëª©+ë‚´ìš©</option>
        <option value="writer">ì‘ì„±ì</option>
    </select>
    <input type="text" name="sv" class="form-control" style="width: 25%; display: inline-block;">
    <button class="form-control btn btn-primary" style="width: 100px; display: inline-block;">ê²€ìƒ‰</button>
</form>
</div>
</div>
```
<br><br>

### SearchController.java
boardList.jspì—ì„œ form íƒœê·¸ action ì†ì„± ê°’ìœ¼ë¡œ ì§€ì •ëœ `${contextPath}/search.do` ìš”ì²­ì„ ë°›ê¸°ìœ„í•´ SearchControllerë¥¼ ìƒì„±í•œë‹¤.<br>

```java
@WebServlet("/search.do")
public class SearchController extends HttpServlet {
	private static final long serialVersionUID = 1L;

	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		String searchKey = request.getParameter("sk");
		String searchValue = request.getParameter("sv");
		String cp = request.getParameter("cp");
	
		try {
			SearchService service = new SearchService();
			
			Map<String, Object> map = new HashMap<String, Object>();
			map.put("searchKey", searchKey);
			map.put("searchValue", searchValue);
			map.put("currentPage", cp);
			
			
			// í˜ì´ì§• ì²˜ë¦¬ë¥¼ ìœ„í•œ ë°ì´í„°ë¥¼ ê³„ì‚°í•˜ê³  ì €ì¥í•˜ëŠ” ê°ì²´ PageInfo ì–»ì–´ì˜¤ê¸°
			PageInfo pInfo = service.getPageInfo(map);
			
			// ê²€ìƒ‰ ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ
			List<Board> bList = service.searchBoardList(map, pInfo);
			
			
			// ì¡°íšŒëœ ë‚´ìš©ê³¼ PageInfo ê°ì²´ë¥¼ request ê°ì²´ì— ë‹´ì•„ì„œ ìš”ì²­ ìœ„ì„
			String path = "/WEB-INF/views/board/boardList.jsp";
			
			request.setAttribute("bList", bList);
			request.setAttribute("pInfo", pInfo);
			
			RequestDispatcher view = request.getRequestDispatcher(path);
			view.forward(request, response);
			
		} catch (Exception e) {
			e.printStackTrace();
			String path = "/WEB-INF/views/common/errorPage.jsp";
			request.setAttribute("errorMsg", "ê²€ìƒ‰ ê³¼ì •ì—ì„œ ì˜¤ë¥˜ ë°œìƒ");
			RequestDispatcher view = request.getRequestDispatcher(path);
			view.forward(request, response);
		}
	}

	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		doGet(request, response);
	}
}
```
<br><br>

### SearchService.java

```java
/** ê²€ìƒ‰ ë‚´ìš©ì´ í¬í•¨ëœ í˜ì´ì§• ì²˜ë¦¬ ì •ë³´ ìƒì„± Service
* @param map
* @return map
* @throws Exception
*/
public PageInfo getPageInfo(Map<String, Object> map) throws Exception {
    Connection conn = getConnection();
    
    // ì–»ì–´ì˜¨ íŒŒë¼ë¯¸í„° cpê°€ nullì´ë©´ 1, ì•„ë‹ˆë©´ int í˜•ìœ¼ë¡œ íŒŒì‹±
    map.put("currentPage",  
        (map.get("currentPage") == null) ? 1 
                    : Integer.parseInt((String)map.get("currentPage")));
    
    // ê²€ìƒ‰ ì¡°ê±´ì— ë”°ë¥¸ SQL ì¡°ê±´ë¬¸ì„ ì¡°í•©í•˜ëŠ” ë©”ì†Œë“œ í˜¸ì¶œ
    String condition = createCondition(map);
    
    // DBì—ì„œ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ê²Œì‹œê¸€ì˜ ìˆ˜ë¥¼ ì¡°íšŒí•˜ê¸°
    int listCount = dao.getListCount(conn, condition);
    
    // ì»¤ë„¥ì…˜ ë°˜í™˜
    close(conn);
    
    // PageInfo ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ ë°˜í™˜
    return new PageInfo((int)map.get("currentPage"), listCount);
}


/** ê²€ìƒ‰ ì¡°ê±´ì— ë”°ë¼ SQLì— ì‚¬ìš©ë  ì¡°ê±´ë¬¸ì„ ì¡°í•©í•˜ëŠ” ë©”ì†Œë“œ
* @param map
* @return 
*/
private String createCondition(Map<String, Object> map) {
    
    String condition = null;
    
    String searchKey = (String)map.get("searchKey");
    String searchValue = (String)map.get("searchValue");
    
    // ê²€ìƒ‰ ì¡°ê±´(searchKey)ì— ë”°ë¼ SQL ì¡°í•©
    switch(searchKey) {
    case "title" :
                    // " BOARD_TITLE LIKE '%' || '49' || '%' "
        condition = " BOARD_TITLE LIKE '%' || '" + searchValue + "' || '%' ";
        break;
        
    case "content" :
        condition = " BOARD_CONTENT LIKE '%' || '" + searchValue + "' || '%' ";
        break;
        
    case "titcont" :
        condition = " (BOARD_TITLE LIKE '%' || '" + searchValue + "' || '%' "
                + "OR BOARD_CONTENT LIKE '%' || '" + searchValue + "' || '%') ";
        break;
        
    case "writer" :
        condition = " MEMBER_ID LIKE '%' || '" + searchValue + "' || '%' ";
        break;
    }
    return condition;
}

/** ê²€ìƒ‰ ê²Œì‹œê¸€ ëª©ë¡ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ Service
* @param map
* @param pInfo 
* @return bList
* @throws Exception
*/
public List<Board> searchBoardList(Map<String, Object> map, PageInfo pInfo) throws Exception {
    Connection conn = getConnection();
    
    String condition = createCondition(map);

    List<Board> bList = dao.searchBoardList(conn, pInfo, condition);
    
    close(conn);
    
    return bList;
}
```
<br><br>

### SearchDAO.java

```java
/** ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ê²Œì‹œê¸€ ìˆ˜ ì¡°íšŒ DAO
    * @param conn
    * @param condition
    * @return listCount
    * @throws Exception
    */

public int getListCount(Connection conn, String condition)  throws Exception{
    int listCount = 0;
    
    String query = "SELECT COUNT(*) FROM V_BOARD WHERE BOARD_STATUS = 'Y' AND" + condition;
    
    try {
        stmt = conn.createStatement();
        rset = stmt.executeQuery(query);
        
        if(rset.next()) {
            listCount = rset.getInt(1);
        }
    } finally {
        close(rset);
        close(stmt);
    }
    return listCount;
}



/** ê²€ìƒ‰ ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ DAO
    * @param conn
    * @param pInfo
    * @param condition
    * @return bList
    * @throws Exception
    */
public List<Board> searchBoardList(Connection conn, PageInfo pInfo, String condition) throws Exception{
    
    List<Board> bList = null;
    
    String query = 
            "SELECT * FROM" + 
            "    (SELECT ROWNUM RNUM , V.*" + 
            "    FROM" + 
            "        (SELECT * FROM V_BOARD " + 
            "        WHERE " + condition + 
            "        AND BOARD_STATUS = 'Y' ORDER BY BOARD_NO DESC) V )" + 
            "WHERE RNUM BETWEEN ? AND ?";
    
    try {
        // SQL êµ¬ë¬¸ ì¡°ê±´ì ˆì— ëŒ€ì…í•  ë³€ìˆ˜ ìƒì„±
        int startRow = (pInfo.getCurrentPage() - 1) * pInfo.getLimit() + 1;
        int endRow = startRow + pInfo.getLimit() -  1;
        
        pstmt = conn.prepareStatement(query);
        
        pstmt.setInt(1, startRow);
        pstmt.setInt(2,  endRow);
        
        rset = pstmt.executeQuery();
        
        bList = new ArrayList<Board>();
        
            while(rset.next()) {
                Board board = new Board(rset.getInt("BOARD_NO"),
                                    rset.getString("BOARD_TITLE"),
                                    rset.getString("MEMBER_ID"),
                                    rset.getInt("READ_COUNT"),
                                    rset.getString("CATEGORY_NM"),
                                    rset.getTimestamp("BOARD_CREATE_DT"));
                bList.add(board);
            }
    } finally {
        close(rset);
        close(pstmt);
    }
    return bList;
}
```
<br><br>

## ê²€ìƒ‰ì°½ì— ì‘ì„±ëœ ê°’ ìœ ì§€í•˜ê¸°
ì´ ê¸°ëŠ¥ì„ ì„¤ì •í•´ì£¼ì§€ ì•Šìœ¼ë©´ ê²€ìƒ‰ í›„ íŠ¹ì • ê²Œì‹œê¸€ì„ ì„ íƒ í›„ ëª©ë¡ í˜ì´ì§€ë¡œ ëŒì•„ì˜¤ë©´ ê²€ìƒ‰ì°½ì— ê²€ìƒ‰í–ˆë˜ ë‚´ìš©ì´ ì‚¬ë¼ì§„ë‹¤. <br><br>


### boardList.jsp

```javascript
<script>   
// ê²Œì‹œê¸€ ìƒì„¸ë³´ê¸° ê¸°ëŠ¥ (jqueryë¥¼ í†µí•´ ì‘ì—…)

// ì•„ë˜ì˜ ë©”ì†Œë“œì— url ì¶”ê°€
$("#list-table td").on("click", function(){
    var url = "${contextPath}/board/view.do?cp=${pInfo.currentPage}&no=" + boardNo + "${searchStr}";
    // /wsp/board/view.do?cp=1&no=500
    });



// ê²€ìƒ‰ ë‚´ìš©ì´ ìˆì„ ê²½ìš° ê²€ìƒ‰ì°½ì— í•´ë‹¹ ë‚´ìš©ì„ ì‘ì„±í•´ë‘ëŠ” ê¸°ëŠ¥
    (function(){
        var searchKey = "${param.sk}";
        // íŒŒë¼ë¯¸í„° ì¤‘ skê°€ ìˆì„ ê²½ìš° ex)"49"
        // íŒŒë¼ë¯¸í„° ì¤‘ skê°€ ì—†ì„ ê²½ìš° ex) ""
        var searchValue = "${param.sv}";
        
        // ê²€ìƒ‰ì°½ selectì˜ optionì„ ë°˜ë³µ ì ‘ê·¼
        $("select[name=sk] > option").each(function(index, item){
        // index : í˜„ì¬ ì ‘ê·¼ ì¤‘ì¸ ìš”ì†Œì˜ ì¸ë±ìŠ¤
        // item : í˜„ì¬ ì ‘ê·¼ ì¤‘ì¸ ìš”ì†Œ
        
                // title          title
        if( $(item).val() == searchKey ){ // ì œëª©ìœ¼ë¡œ ê²€ìƒ‰í•œ ê²½ìš°
            $(item).prop("selected", true);
        }
        });
        
        // ê²€ìƒ‰ì–´ ì…ë ¥ì°½ì— searchValue ê°’ ì¶œë ¥
        $("input[name=sv]").val(searchValue);
        
    })();
</script>
```
<br><br>

### boardView.jsp
ìƒì„¸ ê²Œì‹œê¸€ ì¡°íšŒ í˜ì´ì§€ì—ì„œ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ë„ ê²€ìƒ‰í–ˆë˜ ê°’ì´ ìœ ì§€ë˜ë„ë¡ í•œë‹¤. <br>
```html
<c:choose>
    <c:when test="${!empty param.sk && !empty param.sv}">
        <c:url var="goToList" value="../search.do">
            <c:param name="cp">${param.cp}</c:param>
            <c:param name="sk">${param.sk}</c:param>
            <c:param name="sv">${param.sv}</c:param>
        </c:url>							
    </c:when>
    
    <c:otherwise>
        <c:url var="goToList" value="list.do">
            <c:param name="cp">${param.cp}</c:param>
        </c:url>
    </c:otherwise>
</c:choose>


    <a href="${goToList}" class="btn btn-primary float-right">ëª©ë¡ìœ¼ë¡œ</a>
```
<br><br>

## ë¡œê·¸ì¸ ì—¬ë¶€ì— ë”°ë¥¸ ê¸€ì“°ê¸° ë²„íŠ¼
### boardList.jsp
```html
<%-- ë¡œê·¸ì¸ì´ ë˜ì–´ìˆëŠ” ê²½ìš° --%>
<c:if test="${!empty loginMember}">
<button type="button" class="btn btn-primary float-right" 
    id="insertBtn" onclick="location.href = '${contextPath}/board/insertForm.do'">
        ê¸€ì“°ê¸°
    </button>
</c:if>
```

<br><br>


## ê²Œì‹œê¸€ ì‘ì„±
- ê²Œì‹œê¸€ ì‘ì„± í˜ì´ì§€ <br> ![20210106_04](https://user-images.githubusercontent.com/70805241/103768541-096da900-5066-11eb-8640-279ddaf00cdf.gif) <br><br><br>


### BoardController.java

```java
// ê²Œì‹œê¸€ ì‘ì„± í™”ë©´ ì „í™˜ Controller **********************************
else if(command.equals("/insertForm.do")) {
    
    path = "/WEB-INF/views/board/boardInsert.jsp";
    view = request.getRequestDispatcher(path);
    view.forward(request, response);
    
}
```
<br><br>

### boardInsert.jsp

```html
<body>
    <jsp:include page="../common/header.jsp"></jsp:include>

    <div class="container my-5">

        <h3>ê²Œì‹œê¸€ ë“±ë¡</h3>
        <hr>
        <!-- íŒŒì¼ ì—…ë¡œë“œë¥¼ ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ cos.jar ë¼ì´ë¸ŒëŸ¬ë¦¬ ë‹¤ìš´ë¡œë“œ(http://www.servlets.com/) -->
        
        <!-- 
            - enctype : form íƒœê·¸ ë°ì´í„°ê°€ ì„œë²„ë¡œ ì œì¶œ ë  ë•Œ ì¸ì½”ë”© ë˜ëŠ” ë°©ë²•ì„ ì§€ì •. (POST ë°©ì‹ì¼ ë•Œë§Œ ì‚¬ìš© ê°€ëŠ¥)
            - application/x-www-form-urlencoded : ëª¨ë“  ë¬¸ìë¥¼ ì„œë²„ë¡œ ì „ì†¡í•˜ê¸° ì „ì— ì¸ì½”ë”© (formíƒœê·¸ ê¸°ë³¸ê°’)
            - multipart/form-data : ëª¨ë“  ë¬¸ìë¥¼ ì¸ì½”ë”© í•˜ì§€ ì•ŠìŒ.(ì›ë³¸ ë°ì´í„°ê°€ ìœ ì§€ë˜ì–´ ì´ë¯¸ì§€, íŒŒì¼ë“±ì„ ì„œë²„ë¡œ ì „ì†¡ í•  ìˆ˜ ìˆìŒ.) 
        -->
        <form action="${contextPath}/board/insert.do" method="post" 
                enctype="multipart/form-data" role="form" onsubmit="return boardValidate();">

            <div class="mb-2">
                <label class="input-group-addon mr-3 insert-label">ì¹´í…Œê³ ë¦¬</label> 
                <select	class="custom-select" id="categoryCode" name="categoryCode" style="width: 150px;">
                    <option value="10">ìš´ë™</option>
                    <option value="20">ì˜í™”</option>
                    <option value="30">ìŒì•…</option>
                    <option value="40">ìš”ë¦¬</option>
                    <option value="50">ê²Œì„</option>
                    <option value="60">ê¸°íƒ€</option>
                </select>
            </div>
            <div class="form-inline mb-2">
                <label class="input-group-addon mr-3 insert-label">ì œëª©</label> 
                <input type="text" class="form-control" id="boardTitle" name="boardTitle" size="70">
            </div>

            <div class="form-inline mb-2">
                <label class="input-group-addon mr-3 insert-label">ì‘ì„±ì</label>
                <h5 class="my-0" id="writer">${loginMember.memberId }</h5>
            </div>


            <div class="form-inline mb-2">
                <label class="input-group-addon mr-3 insert-label">ì‘ì„±ì¼</label>
                <h5 class="my-0" id="today"></h5>
            </div>

            <hr>

            <div class="form-inline mb-2">
                <label class="input-group-addon mr-3 insert-label">ì¸ë„¤ì¼</label>
                <div class="boardImg" id="titleImgArea">
                    <img id="titleImg" width="200" height="200">
                </div>
            </div>

            <div class="form-inline mb-2">
                <label class="input-group-addon mr-3 insert-label">ì—…ë¡œë“œ<br>ì´ë¯¸ì§€</label>
                <div class="mr-2 boardImg" id="contentImgArea1">
                    <img id="contentImg1" width="150" height="150">
                </div>

                <div class="mr-2 boardImg" id="contentImgArea2">
                    <img id="contentImg2" width="150" height="150">
                </div>

                <div class="mr-2 boardImg" id="contentImgArea3">
                    <img id="contentImg3" width="150" height="150">
                </div>
            </div>


            <!-- íŒŒì¼ ì—…ë¡œë“œ í•˜ëŠ” ë¶€ë¶„ -->
            <div id="fileArea">
                <input type="file" id="img0" name="img0" onchange="LoadImg(this,0)"> 
                <input type="file" id="img1" name="img1" onchange="LoadImg(this,1)"> 
                <input type="file" id="img2" name="img2" onchange="LoadImg(this,2)"> 
                <input type="file" id="img3" name="img3" onchange="LoadImg(this,3)">
            </div>

            <div class="form-group">
                <div>
                    <label for="content">ë‚´ìš©</label>
                </div>
                <textarea class="form-control" id="boardContent" name="boardContent" rows="15" style="resize: none;"></textarea>
            </div>


            <hr class="mb-4">

            <div class="text-center">
                <button type="submit" class="btn btn-primary">ë“±ë¡</button>
                <button type="button" class="btn btn-primary">ëª©ë¡ìœ¼ë¡œ</button>
            </div>

        </form>
    </div>

    <jsp:include page="../common/footer.jsp"></jsp:include>
<body>
```
<br><br>


## íŒŒì¼ ì˜¬ë¦¬ê¸°, ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
![20210106_05](https://user-images.githubusercontent.com/70805241/103781023-21025d00-5079-11eb-9d80-fb09144fd0a4.gif) <br><br>

### ë¼ì´ë¸ŒëŸ¬ë¦¬ ë‹¤ìš´
[![20210106_05](https://user-images.githubusercontent.com/70805241/103783746-6c6a3a80-507c-11eb-99b7-2266e715bbaa.JPG)](http://www.servlets.com/ "í™ˆí˜ì´ì§€ë¡œ ì´ë™") <br>
ğŸ‘†ğŸ¼ ì´ë¯¸ì§€ í´ë¦­ ì‹œ ê³µì‹í™ˆí˜ì´ì§€ë¡œ ì´ë™ <br><br>

- í™ˆí˜ì´ì§€ ì¢Œì¸¡ `COS File Upload Library` í´ë¦­ <br> ![20210106_06](https://user-images.githubusercontent.com/70805241/103784989-fd8de100-507d-11eb-9772-901356d8d26a.JPG) <br><br>
- í˜ì´ì§€ í•˜ë‹¨ `cos-20.08.zip` í´ë¦­ <br> ![20210106_07](https://user-images.githubusercontent.com/70805241/103784953-f5ce3c80-507d-11eb-9430-d127ad45a283.JPG) <br><br>
- ë‹¤ìš´ í›„ ì••ì¶• í’€ê¸°
- `\cos-20.08\lib` ê²½ë¡œì— ìˆëŠ” cos.jar ë³µì‚¬ <br>
- ì•„ë˜ì˜ ê²½ë¡œì— ë¶™ì—¬ë„£ê¸° <br> ![20210106_08](https://user-images.githubusercontent.com/70805241/103785291-61b0a500-507e-11eb-80c0-c6636f0bd663.JPG) <br><br><br>


### boardInsert.jsp

```html
<script>
    $(function(){
        $("#fileArea").hide(); //#fileArea ìš”ì†Œë¥¼ ìˆ¨ê¹€
        
        $(".boardImg").on("click", function(){ //ì´ë¯¸ì§€ ì˜ì—­ì´ í´ë¦­ë˜ì—ˆì‘ã„¹ë•Œ
        //í´ë¦­í•œ ì´ë¯¸ì§€ ì˜ì—­ ì¸ë±ìŠ¤ ì–»ì–´ì˜¤ê¸°
        var index = $(".boardImg").index(this); // í´ë¦­ëœ ìš”ì†Œê°€ .boardImgì¤‘ ëª‡ë²ˆì§¸ ì¸ë±ìŠ¤ì¸ì§€ ë°˜í™˜
        
        //í´ë¦­ëœ ì˜ì—­ ì¸ë±ìŠ¤ì— ë§ëŠ” input fileíƒœê·¸ í´ë¦­
        $("#img" + index).click();
        });
    });
    
    // ê°ê°ì˜ ì˜ì—­ì— íŒŒì¼ì„ ì²¨ë¶€ í–ˆì„ ê²½ìš° ë¯¸ë¦¬ ë³´ê¸°ê°€ ê°€ëŠ¥í•˜ë„ë¡ í•˜ëŠ” í•¨ìˆ˜
    function LoadImg(value, num) {
    //value.files : íŒŒì¼ì´ ì—…ë¡œë“œë˜ì–´ ìˆìœ¼ë©´ true
    //value.files[0] : ì—¬ëŸ¬ íŒŒì¼ ì¤‘ ì²«ë²ˆì§¸ íŒŒì¼ì´ ì—…ë¡œë“œ ë˜ì–´ ìˆìœ¼ë©´ true
        if(value.files && value.files[0]) {//í•´ë‹¹ ìš”ì†Œì— ì—…ë¡œë“œëœ íŒŒì¼ì´ ìˆì„ ê²½ìš°
        var reader = new FileReader();
        // ìë°”ìŠ¤í¬ë¦½íŠ¸ FileReader
            // ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë¹„ë™ê¸°ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì½ê¸° ìœ„í•˜ì—¬ ì½ì„ íŒŒì¼ì„ ê°€ë¦¬í‚¤ëŠ” File í˜¹ì€ Blobê°ì²´ë¥¼ ì´ìš©í•´ íŒŒì¼ì˜ ë‚´ìš©ì„ ì½ê³  ì‚¬ìš©ìì˜ ì»´í“¨í„°ì— ì €ì¥í•˜ëŠ” ê²ƒì„ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” ê°ì²´
            
            reader.readAsDataURL(value.files[0]);
        // FileReader.readAsDataURL()
        // ì§€ì •ëœì˜ ë‚´ìš©ì„ ì½ê¸° ì‹œì‘í•©ë‹ˆë‹¤. Blobì™„ë£Œë˜ë©´ resultì†ì„± data:ì— íŒŒì¼ ë°ì´í„°ë¥¼ ë‚˜íƒ€ë‚´ëŠ” URLì´ í¬í•¨ ë©ë‹ˆë‹¤.
        
        reader.onload = function(e){
        // FileReader.onload
        // load ì´ë²¤íŠ¸ì˜ í•¸ë“¤ëŸ¬. ì´ ì´ë²¤íŠ¸ëŠ” ì½ê¸° ë™ì‘ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œ ë˜ì—ˆì„ ë•Œë§ˆë‹¤ ë°œìƒí•©ë‹ˆë‹¤.
        
        //ì½ì–´ë“¤ì¸ ë‚´ìš©ì„ ì¶œë ¥
        $(".boardImg").eq(num).children("img").attr("src", e.target.result);
        //e.target.result : íŒŒì¼ ì½ê¸° ë™ì‘ì„ ì„±ê³µí•œ ìš”ì†Œê°€ ì½ì–´ë“¤ì¸ íŒŒì¼ ë‚´ìš©
        }
        }
    }
</script>
```